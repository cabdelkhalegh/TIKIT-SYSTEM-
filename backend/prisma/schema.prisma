// TIKIT System - Database Schema
// PRD Section 4.2: Client Company Profile Entity

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// Client Entity - Represents marketing client companies in TIKIT platform
model Client {
  clientId                 String   @id @default(uuid()) @map("client_id")
  legalCompanyName         String   @map("legal_company_name")
  brandDisplayName         String   @map("brand_display_name")
  industryVertical         String?  @map("industry_vertical")
  
  // Contact information stored as JSON strings
  // Expected format: JSON array of strings, e.g., ["email1@example.com", "email2@example.com"]
  primaryContactEmails     String   @map("primary_contact_emails")
  billingContactEmails     String   @map("billing_contact_emails")
  // Expected format: JSON array of channel names, e.g., ["email", "slack", "phone"]
  preferredCommChannels    String   @map("preferred_comm_channels")
  
  // Campaign relationships
  campaigns                Campaign[]
  
  // Financial tracking
  totalAdSpend             Float?   @default(0) @map("total_ad_spend")
  performanceMetricsJson   String?  @map("performance_metrics_json")
  
  // Timestamps
  accountCreatedAt         DateTime @default(now()) @map("account_created_at")
  lastModifiedAt           DateTime @updatedAt @map("last_modified_at")

  @@map("clients")
}

// Campaign Entity - Represents marketing campaigns in TIKIT platform
// PRD Section 4.3: Campaign Management
model Campaign {
  campaignId               String   @id @default(uuid()) @map("campaign_id")
  
  // Campaign metadata
  campaignName             String   @map("campaign_name")
  campaignDescription      String?  @map("campaign_description")
  campaignObjectives       String?  @map("campaign_objectives") // JSON array of objectives
  
  // Client relationship - simplified to single relation with status tracking
  clientId                 String   @map("client_id")
  client                   Client   @relation(fields: [clientId], references: [clientId], onDelete: Cascade)
  
  // Campaign status tracking
  // Possible values: "draft", "active", "paused", "completed", "cancelled"
  status                   String   @default("draft") @map("status")
  
  // Budget and financial tracking
  totalBudget              Float?   @map("total_budget")
  allocatedBudget          Float?   @default(0) @map("allocated_budget")
  spentBudget              Float?   @default(0) @map("spent_budget")
  
  // Timeline management
  startDate                DateTime? @map("start_date")
  endDate                  DateTime? @map("end_date")
  launchDate               DateTime? @map("launch_date")
  
  // Target audience (stored as JSON)
  // Expected format: JSON object with demographics, interests, locations, etc.
  targetAudienceJson       String?  @map("target_audience_json")
  
  // Target platforms (stored as JSON array)
  // Expected format: JSON array like ["instagram", "tiktok", "youtube"]
  targetPlatformsJson      String?  @map("target_platforms_json")
  
  // Performance metrics and KPIs (stored as JSON)
  // Expected format: JSON object with impressions, engagement, conversions, ROI, etc.
  performanceKPIsJson      String?  @map("performance_kpis_json")
  actualPerformanceJson    String?  @map("actual_performance_json")
  
  // Future relationships (to be added in Phase 2.3)
  // influencers            Influencer[] @relation("CampaignInfluencers")
  // content                Content[] @relation("CampaignContent")
  
  // Timestamps
  createdAt                DateTime @default(now()) @map("created_at")
  updatedAt                DateTime @updatedAt @map("updated_at")

  @@map("campaigns")
  @@index([clientId])
  @@index([status])
}

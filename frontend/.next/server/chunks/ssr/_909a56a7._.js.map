{"version":3,"sources":["../../../../utils/rbac.ts","../../../../app/pending-approval/page.tsx"],"sourcesContent":["import { UserRole, Profile } from '@/types';\n\n// Role hierarchy per PRD v1.2 Section 2\n// Higher number = more permissions\nconst roleHierarchy: Record<UserRole, number> = {\n  director: 6,         // Super-user - full access\n  finance: 5,          // Financial control\n  campaign_manager: 4, // Runs campaigns\n  reviewer: 3,         // Quality & approvals\n  influencer: 2,       // External contributor\n  client: 1,           // External approver (limited view)\n};\n\n/**\n * Check if user has a specific role\n */\nexport function hasRole(profile: Profile | null, role: UserRole): boolean {\n  if (!profile || !profile.role || !profile.role_approved) return false;\n  return profile.role === role;\n}\n\n/**\n * Check if user has at least the minimum required role\n */\nexport function hasMinimumRole(profile: Profile | null, minRole: UserRole): boolean {\n  if (!profile || !profile.role || !profile.role_approved) return false;\n  return roleHierarchy[profile.role] >= roleHierarchy[minRole];\n}\n\n/**\n * Check if user is a director\n */\nexport function isDirector(profile: Profile | null): boolean {\n  return hasRole(profile, 'director');\n}\n\n/**\n * Check if user is finance role or higher\n */\nexport function isFinanceOrHigher(profile: Profile | null): boolean {\n  return hasMinimumRole(profile, 'finance');\n}\n\n/**\n * Check if user is a campaign manager or higher\n */\nexport function isCampaignManagerOrHigher(profile: Profile | null): boolean {\n  return hasMinimumRole(profile, 'campaign_manager');\n}\n\n/**\n * Check if user is a reviewer or higher\n */\nexport function isReviewerOrHigher(profile: Profile | null): boolean {\n  return hasMinimumRole(profile, 'reviewer');\n}\n\n/**\n * Get allowed routes for a user role per PRD v1.2\n */\nexport function getAllowedRoutes(role: UserRole | null): string[] {\n  if (!role) return ['/'];\n\n  const baseRoutes = ['/dashboard', '/profile'];\n\n  switch (role) {\n    case 'director':\n      // Super-user: Full access to everything\n      return [\n        ...baseRoutes,\n        '/users',\n        '/invitations',\n        '/campaigns',\n        '/clients',\n        '/influencers',\n        '/content',\n        '/reports',\n        '/finance',\n        '/invoices',\n      ];\n    case 'finance':\n      // Financial control: Invoices, reports, campaigns\n      return [\n        ...baseRoutes,\n        '/campaigns',\n        '/clients',\n        '/influencers',\n        '/reports',\n        '/finance',\n        '/invoices',\n      ];\n    case 'campaign_manager':\n      // Runs campaigns: Manage campaigns, clients, influencers, content\n      return [\n        ...baseRoutes,\n        '/campaigns',\n        '/clients',\n        '/influencers',\n        '/content',\n        '/reports',\n      ];\n    case 'reviewer':\n      // Quality & approvals: Review briefs, content, reports\n      return [\n        ...baseRoutes,\n        '/campaigns',\n        '/content',\n        '/reports',\n      ];\n    case 'influencer':\n      // External contributor: View own campaigns, upload content\n      return [...baseRoutes, '/campaigns', '/content'];\n    case 'client':\n      // External approver: View campaigns and reports\n      return [...baseRoutes, '/campaigns', '/reports'];\n    default:\n      return baseRoutes;\n  }\n}\n\n/**\n * Check if route is allowed for user\n */\nexport function isRouteAllowed(profile: Profile | null, path: string): boolean {\n  if (!profile || !profile.role || !profile.role_approved) {\n    return path === '/' || path === '/login' || path === '/signup';\n  }\n\n  // Public routes\n  if (path === '/' || path === '/login' || path === '/signup') {\n    return true;\n  }\n\n  const allowedRoutes = getAllowedRoutes(profile.role);\n  return allowedRoutes.some(route => path.startsWith(route));\n}\n\n/**\n * Get role display name per PRD v1.2\n */\nexport function getRoleDisplayName(role: UserRole): string {\n  const names: Record<UserRole, string> = {\n    director: 'Director',\n    campaign_manager: 'Campaign Manager',\n    reviewer: 'Reviewer',\n    finance: 'Finance',\n    influencer: 'Influencer',\n    client: 'Client',\n  };\n  return names[role];\n}\n\n/**\n * Get role badge color\n */\nexport function getRoleBadgeColor(role: UserRole): string {\n  const colors: Record<UserRole, string> = {\n    director: 'bg-purple-100 text-purple-800',\n    campaign_manager: 'bg-blue-100 text-blue-800',\n    reviewer: 'bg-yellow-100 text-yellow-800',\n    finance: 'bg-green-100 text-green-800',\n    influencer: 'bg-pink-100 text-pink-800',\n    client: 'bg-gray-100 text-gray-800',\n  };\n  return colors[role];\n}\n\n/**\n * Get role description per PRD v1.2\n */\nexport function getRoleDescription(role: UserRole): string {\n  const descriptions: Record<UserRole, string> = {\n    director: 'Super-user with global visibility, budget overrides, and exception approvals',\n    campaign_manager: 'Runs campaigns - create/edit campaigns, manage workflows',\n    reviewer: 'Quality & approvals - approve briefs, content, and reports',\n    finance: 'Financial control - create & approve invoices, mark as paid',\n    influencer: 'External contributor - upload content, connect Instagram, view status',\n    client: 'External approver - view & approve shortlist, content, and reports',\n  };\n  return descriptions[role];\n}\n","'use client';\n\nimport { useAuth } from '@/contexts/AuthContext';\nimport { getRoleDisplayName } from '@/utils/rbac';\n\nexport default function PendingApprovalPage() {\n  const { profile, signOut } = useAuth();\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <div className=\"text-center\">\n          <div className=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100\">\n            <svg\n              className=\"h-6 w-6 text-yellow-600\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"\n              />\n            </svg>\n          </div>\n          <h2 className=\"mt-6 text-3xl font-extrabold text-gray-900\">\n            Pending Approval\n          </h2>\n          <div className=\"mt-4 bg-white shadow overflow-hidden rounded-lg p-6\">\n            <p className=\"text-gray-600\">\n              Your account has been created and is pending approval from a director.\n            </p>\n            {profile?.role && (\n              <div className=\"mt-4\">\n                <p className=\"text-sm text-gray-500\">\n                  Role: <span className=\"font-medium\">{getRoleDisplayName(profile.role)}</span>\n                </p>\n                <p className=\"text-sm text-gray-500\">\n                  Email: <span className=\"font-medium\">{profile.email}</span>\n                </p>\n              </div>\n            )}\n            <p className=\"mt-4 text-sm text-gray-500\">\n              You will be notified via email once your account has been approved.\n            </p>\n          </div>\n          <button\n            onClick={() => signOut()}\n            className=\"mt-6 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500\"\n          >\n            Sign out\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"uCAIA,IAAM,EAA0C,CAC9C,SAAU,EACV,QAAS,EACT,iBAAkB,EAClB,SAAU,EACV,WAAY,EACZ,OAAQ,CACV,EAKO,SAAS,EAAQ,CAAuB,CAAE,CAAc,QAC7D,CAAI,CAAC,IAAW,CAAC,EAAQ,IAAI,GAAI,CAAC,EAAQ,aAAa,EAChD,AADkD,EAC1C,IAAI,CAD6C,EACxC,CAC1B,CAKO,SAAS,EAAe,CAAuB,CAAE,CAAiB,QACvE,CAAI,CAAC,IAAW,CAAC,EAAQ,IAAI,GAAI,CAAC,EAAQ,aAAa,EAAE,AAClD,CAAa,CAAC,EAAQ,GADmC,CAC/B,CAAC,EAAI,CAAa,CAAC,EAAQ,AAC9D,CAKO,SAAS,EAAW,CAAuB,EAChD,OAAO,EAAQ,EAAS,WAC1B,CAYO,SAAS,EAA0B,CAAuB,EAC/D,OAAO,EAAe,EAAS,mBACjC,CA4FO,SAAS,EAAmB,CAAc,EAS/C,MAAO,CARiC,CACtC,SAAU,WACV,iBAAkB,mBAClB,SAAU,WACV,QAAS,UACT,WAAY,aACZ,OAAQ,QACV,EACY,CAAC,EAAK,AACpB,CAKO,SAAS,EAAkB,CAAc,EAS9C,MAAO,CARkC,CACvC,SAAU,gCACV,iBAAkB,4BAClB,SAAU,gCACV,QAAS,8BACT,WAAY,4BACZ,OAAQ,4BACV,CACa,CAAC,EAAK,AACrB,kMCnKA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEe,SAAS,IACtB,GAAM,SAAE,CAAO,SAAE,CAAO,CAAE,CAAG,CAAA,EAAA,EAAA,OAAA,AAAO,IAEpC,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+FACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yFACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAU,0BACV,KAAK,OACL,QAAQ,YACR,OAAO,wBAEP,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACC,cAAc,QACd,eAAe,QACf,YAAa,EACb,EAAE,oDAIR,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sDAA6C,qBAG3D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gEACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yBAAgB,2EAG5B,GAAS,MACR,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,kCAAwB,SAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAe,CAAA,EAAA,EAAA,kBAAA,AAAkB,EAAC,EAAQ,IAAI,OAEtE,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,kCAAwB,UAC5B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAe,EAAQ,KAAK,SAIzD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sCAA6B,2EAI5C,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,IACf,UAAU,qOACX,mBAOX"}
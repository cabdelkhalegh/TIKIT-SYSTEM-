{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","../../../../utils/rbac.ts","../../../../components/ProtectedRoute.tsx","../../../../app/profile/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","import { UserRole, Profile } from '@/types';\n\n// Role hierarchy per PRD v1.2 Section 2\n// Higher number = more permissions\nconst roleHierarchy: Record<UserRole, number> = {\n  director: 6,         // Super-user - full access\n  finance: 5,          // Financial control\n  campaign_manager: 4, // Runs campaigns\n  reviewer: 3,         // Quality & approvals\n  influencer: 2,       // External contributor\n  client: 1,           // External approver (limited view)\n};\n\n/**\n * Check if user has a specific role\n */\nexport function hasRole(profile: Profile | null, role: UserRole): boolean {\n  if (!profile || !profile.role || !profile.role_approved) return false;\n  return profile.role === role;\n}\n\n/**\n * Check if user has at least the minimum required role\n */\nexport function hasMinimumRole(profile: Profile | null, minRole: UserRole): boolean {\n  if (!profile || !profile.role || !profile.role_approved) return false;\n  return roleHierarchy[profile.role] >= roleHierarchy[minRole];\n}\n\n/**\n * Check if user is a director\n */\nexport function isDirector(profile: Profile | null): boolean {\n  return hasRole(profile, 'director');\n}\n\n/**\n * Check if user is finance role or higher\n */\nexport function isFinanceOrHigher(profile: Profile | null): boolean {\n  return hasMinimumRole(profile, 'finance');\n}\n\n/**\n * Check if user is a campaign manager or higher\n */\nexport function isCampaignManagerOrHigher(profile: Profile | null): boolean {\n  return hasMinimumRole(profile, 'campaign_manager');\n}\n\n/**\n * Check if user is a reviewer or higher\n */\nexport function isReviewerOrHigher(profile: Profile | null): boolean {\n  return hasMinimumRole(profile, 'reviewer');\n}\n\n/**\n * Get allowed routes for a user role per PRD v1.2\n */\nexport function getAllowedRoutes(role: UserRole | null): string[] {\n  if (!role) return ['/'];\n\n  const baseRoutes = ['/dashboard', '/profile'];\n\n  switch (role) {\n    case 'director':\n      // Super-user: Full access to everything\n      return [\n        ...baseRoutes,\n        '/users',\n        '/invitations',\n        '/campaigns',\n        '/clients',\n        '/influencers',\n        '/content',\n        '/reports',\n        '/finance',\n        '/invoices',\n      ];\n    case 'finance':\n      // Financial control: Invoices, reports, campaigns\n      return [\n        ...baseRoutes,\n        '/campaigns',\n        '/clients',\n        '/influencers',\n        '/reports',\n        '/finance',\n        '/invoices',\n      ];\n    case 'campaign_manager':\n      // Runs campaigns: Manage campaigns, clients, influencers, content\n      return [\n        ...baseRoutes,\n        '/campaigns',\n        '/clients',\n        '/influencers',\n        '/content',\n        '/reports',\n      ];\n    case 'reviewer':\n      // Quality & approvals: Review briefs, content, reports\n      return [\n        ...baseRoutes,\n        '/campaigns',\n        '/content',\n        '/reports',\n      ];\n    case 'influencer':\n      // External contributor: View own campaigns, upload content\n      return [...baseRoutes, '/campaigns', '/content'];\n    case 'client':\n      // External approver: View campaigns and reports\n      return [...baseRoutes, '/campaigns', '/reports'];\n    default:\n      return baseRoutes;\n  }\n}\n\n/**\n * Check if route is allowed for user\n */\nexport function isRouteAllowed(profile: Profile | null, path: string): boolean {\n  if (!profile || !profile.role || !profile.role_approved) {\n    return path === '/' || path === '/login' || path === '/signup';\n  }\n\n  // Public routes\n  if (path === '/' || path === '/login' || path === '/signup') {\n    return true;\n  }\n\n  const allowedRoutes = getAllowedRoutes(profile.role);\n  return allowedRoutes.some(route => path.startsWith(route));\n}\n\n/**\n * Get role display name per PRD v1.2\n */\nexport function getRoleDisplayName(role: UserRole): string {\n  const names: Record<UserRole, string> = {\n    director: 'Director',\n    campaign_manager: 'Campaign Manager',\n    reviewer: 'Reviewer',\n    finance: 'Finance',\n    influencer: 'Influencer',\n    client: 'Client',\n  };\n  return names[role];\n}\n\n/**\n * Get role badge color\n */\nexport function getRoleBadgeColor(role: UserRole): string {\n  const colors: Record<UserRole, string> = {\n    director: 'bg-purple-100 text-purple-800',\n    campaign_manager: 'bg-blue-100 text-blue-800',\n    reviewer: 'bg-yellow-100 text-yellow-800',\n    finance: 'bg-green-100 text-green-800',\n    influencer: 'bg-pink-100 text-pink-800',\n    client: 'bg-gray-100 text-gray-800',\n  };\n  return colors[role];\n}\n\n/**\n * Get role description per PRD v1.2\n */\nexport function getRoleDescription(role: UserRole): string {\n  const descriptions: Record<UserRole, string> = {\n    director: 'Super-user with global visibility, budget overrides, and exception approvals',\n    campaign_manager: 'Runs campaigns - create/edit campaigns, manage workflows',\n    reviewer: 'Quality & approvals - approve briefs, content, and reports',\n    finance: 'Financial control - create & approve invoices, mark as paid',\n    influencer: 'External contributor - upload content, connect Instagram, view status',\n    client: 'External approver - view & approve shortlist, content, and reports',\n  };\n  return descriptions[role];\n}\n","'use client';\n\nimport { useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { isRouteAllowed } from '@/utils/rbac';\n\ninterface ProtectedRouteProps {\n  children: React.ReactNode;\n  requiredApproval?: boolean;\n}\n\nexport default function ProtectedRoute({ \n  children, \n  requiredApproval = true \n}: ProtectedRouteProps) {\n  const { profile, loading } = useAuth();\n  const router = useRouter();\n\n  useEffect(() => {\n    if (!loading) {\n      // Not authenticated\n      if (!profile) {\n        router.push('/login');\n        return;\n      }\n\n      // Role not approved yet\n      if (requiredApproval && (!profile.role || !profile.role_approved)) {\n        router.push('/pending-approval');\n        return;\n      }\n\n      // Check route access\n      if (typeof window !== 'undefined') {\n        const currentPath = window.location.pathname;\n        if (!isRouteAllowed(profile, currentPath)) {\n          router.push('/dashboard');\n          return;\n        }\n      }\n    }\n  }, [profile, loading, router, requiredApproval]);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600\"></div>\n      </div>\n    );\n  }\n\n  if (!profile || (requiredApproval && (!profile.role || !profile.role_approved))) {\n    return null;\n  }\n\n  return <>{children}</>;\n}\n","'use client';\n\nimport { useAuth } from '@/contexts/AuthContext';\nimport ProtectedRoute from '@/components/ProtectedRoute';\nimport Link from 'next/link';\nimport { useRouter } from 'next/navigation';\n\nexport default function ProfilePage() {\n  const { profile, signOut } = useAuth();\n  const router = useRouter();\n\n  const handleSignOut = async () => {\n    await signOut();\n    router.push('/login');\n  };\n\n  return (\n    <ProtectedRoute>\n      <div className=\"min-h-screen bg-gray-50\">\n        {/* Navigation */}\n        <nav className=\"bg-white shadow-sm\">\n          <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n            <div className=\"flex justify-between h-16\">\n              <div className=\"flex\">\n                <div className=\"flex-shrink-0 flex items-center\">\n                  <h1 className=\"text-xl font-bold text-purple-600\">TiKiT</h1>\n                </div>\n                <div className=\"hidden sm:ml-6 sm:flex sm:space-x-8\">\n                  <Link\n                    href=\"/dashboard\"\n                    className=\"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium\"\n                  >\n                    Dashboard\n                  </Link>\n                  <Link\n                    href=\"/profile\"\n                    className=\"border-purple-500 text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium\"\n                  >\n                    Profile\n                  </Link>\n                </div>\n              </div>\n              <div className=\"flex items-center\">\n                <button\n                  onClick={handleSignOut}\n                  className=\"ml-3 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700\"\n                >\n                  Sign out\n                </button>\n              </div>\n            </div>\n          </div>\n        </nav>\n\n        {/* Main content */}\n        <div className=\"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8\">\n          <div className=\"px-4 py-6 sm:px-0\">\n            <h2 className=\"text-2xl font-bold text-gray-900 mb-6\">Profile</h2>\n            \n            <div className=\"bg-white shadow overflow-hidden sm:rounded-lg\">\n              <div className=\"px-4 py-5 sm:px-6\">\n                <h3 className=\"text-lg leading-6 font-medium text-gray-900\">\n                  User Information\n                </h3>\n                <p className=\"mt-1 max-w-2xl text-sm text-gray-500\">\n                  Personal details and role information.\n                </p>\n              </div>\n              <div className=\"border-t border-gray-200\">\n                <dl>\n                  <div className=\"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6\">\n                    <dt className=\"text-sm font-medium text-gray-500\">Full name</dt>\n                    <dd className=\"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2\">\n                      {profile?.full_name || 'Not set'}\n                    </dd>\n                  </div>\n                  <div className=\"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6\">\n                    <dt className=\"text-sm font-medium text-gray-500\">Email address</dt>\n                    <dd className=\"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2\">\n                      {profile?.email}\n                    </dd>\n                  </div>\n                  <div className=\"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6\">\n                    <dt className=\"text-sm font-medium text-gray-500\">Role</dt>\n                    <dd className=\"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2\">\n                      {profile?.role || 'Not assigned'}\n                    </dd>\n                  </div>\n                  <div className=\"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6\">\n                    <dt className=\"text-sm font-medium text-gray-500\">Role Status</dt>\n                    <dd className=\"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2\">\n                      <span\n                        className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${\n                          profile?.role_approved\n                            ? 'bg-green-100 text-green-800'\n                            : 'bg-yellow-100 text-yellow-800'\n                        }`}\n                      >\n                        {profile?.role_approved ? 'Approved' : 'Pending Approval'}\n                      </span>\n                    </dd>\n                  </div>\n                </dl>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </ProtectedRoute>\n  );\n}\n"],"names":["module","exports","require","vendored","AppRouterContext","HooksClientContext","ServerInsertedHtml","ReactServerDOMTurbopackClient"],"mappings":"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","ignoreList":[0,1,2,3]}
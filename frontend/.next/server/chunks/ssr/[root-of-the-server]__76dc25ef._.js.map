{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","../../../../app/signup/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","'use client';\n\nimport { useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport Link from 'next/link';\nimport { supabase } from '@/lib/supabase';\n\nexport default function SignupPage() {\n  const router = useRouter();\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [fullName, setFullName] = useState('');\n  const [inviteCode, setInviteCode] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleSignup = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n    setLoading(true);\n\n    try {\n      // Validate invite code first\n      const { data: invitation, error: inviteError } = await supabase\n        .from('invitations')\n        .select('*')\n        .eq('invite_code', inviteCode.toUpperCase())\n        .eq('email', email.toLowerCase())\n        .eq('status', 'pending')\n        .single();\n\n      if (inviteError || !invitation) {\n        setError('Invalid or expired invite code for this email');\n        setLoading(false);\n        return;\n      }\n\n      // Check if invitation is expired\n      if (new Date(invitation.expires_at) < new Date()) {\n        setError('This invitation has expired');\n        setLoading(false);\n        return;\n      }\n\n      // Create auth user\n      const { data: authData, error: authError } = await supabase.auth.signUp({\n        email,\n        password,\n        options: {\n          data: {\n            full_name: fullName,\n          },\n        },\n      });\n\n      if (authError) throw authError;\n\n      if (authData.user) {\n        // Create profile with role from invitation\n        const { error: profileError } = await supabase\n          .from('profiles')\n          .insert({\n            id: authData.user.id,\n            email: email.toLowerCase(),\n            full_name: fullName,\n            role: invitation.role,\n            role_approved: invitation.role !== 'director', // Directors need manual approval\n          });\n\n        if (profileError) throw profileError;\n\n        // Update invitation status\n        await supabase\n          .from('invitations')\n          .update({\n            status: 'accepted',\n            accepted_at: new Date().toISOString(),\n          })\n          .eq('id', invitation.id);\n\n        // Redirect based on role\n        if (invitation.role === 'director') {\n          router.push('/pending-approval');\n        } else {\n          router.push('/dashboard');\n        }\n      }\n    } catch (err: any) {\n      setError(err.message || 'An error occurred during signup');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <div>\n          <h2 className=\"mt-6 text-center text-3xl font-extrabold text-gray-900\">\n            Create your TiKiT account\n          </h2>\n          <p className=\"mt-2 text-center text-sm text-gray-600\">\n            Invitation code required\n          </p>\n        </div>\n        <form className=\"mt-8 space-y-6\" onSubmit={handleSignup}>\n          <div className=\"rounded-md shadow-sm -space-y-px\">\n            <div>\n              <label htmlFor=\"invite-code\" className=\"sr-only\">\n                Invite Code\n              </label>\n              <input\n                id=\"invite-code\"\n                name=\"inviteCode\"\n                type=\"text\"\n                required\n                className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm\"\n                placeholder=\"Invite Code\"\n                value={inviteCode}\n                onChange={(e) => setInviteCode(e.target.value.toUpperCase())}\n              />\n            </div>\n            <div>\n              <label htmlFor=\"email-address\" className=\"sr-only\">\n                Email address\n              </label>\n              <input\n                id=\"email-address\"\n                name=\"email\"\n                type=\"email\"\n                autoComplete=\"email\"\n                required\n                className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm\"\n                placeholder=\"Email address\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n              />\n            </div>\n            <div>\n              <label htmlFor=\"full-name\" className=\"sr-only\">\n                Full Name\n              </label>\n              <input\n                id=\"full-name\"\n                name=\"fullName\"\n                type=\"text\"\n                required\n                className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm\"\n                placeholder=\"Full Name\"\n                value={fullName}\n                onChange={(e) => setFullName(e.target.value)}\n              />\n            </div>\n            <div>\n              <label htmlFor=\"password\" className=\"sr-only\">\n                Password\n              </label>\n              <input\n                id=\"password\"\n                name=\"password\"\n                type=\"password\"\n                autoComplete=\"new-password\"\n                required\n                className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm\"\n                placeholder=\"Password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n              />\n            </div>\n          </div>\n\n          {error && (\n            <div className=\"rounded-md bg-red-50 p-4\">\n              <p className=\"text-sm text-red-800\">{error}</p>\n            </div>\n          )}\n\n          <div>\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50\"\n            >\n              {loading ? 'Creating account...' : 'Sign up'}\n            </button>\n          </div>\n\n          <div className=\"text-center\">\n            <Link href=\"/login\" className=\"text-sm text-purple-600 hover:text-purple-500\">\n              Already have an account? Sign in\n            </Link>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":["module","exports","require","vendored","AppRouterContext","HooksClientContext","ServerInsertedHtml","ReactServerDOMTurbopackClient"],"mappings":"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","ignoreList":[0,1,2,3]}
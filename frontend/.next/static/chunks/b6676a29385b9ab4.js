(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,26683,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566),n=e.i(83642),s=e.i(4249);function i({children:e,requiredApproval:i=!0}){let{profile:l,loading:d}=(0,n.useAuth)(),c=(0,r.useRouter)();return((0,a.useEffect)(()=>{if(!d){if(!l)return void c.push("/login");if(i&&(!l.role||!l.role_approved))return void c.push("/pending-approval");{let e=window.location.pathname;if(!(0,s.isRouteAllowed)(l,e))return void c.push("/dashboard")}}},[l,d,c,i]),d)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):l&&(!i||l.role&&l.role_approved)?(0,t.jsx)(t.Fragment,{children:e}):null}e.s(["default",()=>i])},18566,(e,t,a)=>{t.exports=e.r(76562)},4249,e=>{"use strict";let t={director:6,finance:5,campaign_manager:4,reviewer:3,influencer:2,client:1};function a(e,t){return!!e&&!!e.role&&!!e.role_approved&&e.role===t}function r(e,a){return!!e&&!!e.role&&!!e.role_approved&&t[e.role]>=t[a]}function n(e){return a(e,"director")}function s(e){return r(e,"campaign_manager")}function i(e,t){return e&&e.role&&e.role_approved?"/"===t||"/login"===t||"/signup"===t||(function(e){if(!e)return["/"];let t=["/dashboard","/profile"];switch(e){case"director":return[...t,"/users","/invitations","/campaigns","/clients","/influencers","/content","/reports","/finance","/invoices"];case"finance":return[...t,"/campaigns","/clients","/influencers","/reports","/finance","/invoices"];case"campaign_manager":return[...t,"/campaigns","/clients","/influencers","/content","/reports"];case"reviewer":return[...t,"/campaigns","/content","/reports"];case"influencer":return[...t,"/campaigns","/content"];case"client":return[...t,"/campaigns","/reports"];default:return t}})(e.role).some(e=>t.startsWith(e)):"/"===t||"/login"===t||"/signup"===t}function l(e){return({director:"Director",campaign_manager:"Campaign Manager",reviewer:"Reviewer",finance:"Finance",influencer:"Influencer",client:"Client"})[e]}function d(e){return({director:"bg-purple-100 text-purple-800",campaign_manager:"bg-blue-100 text-blue-800",reviewer:"bg-yellow-100 text-yellow-800",finance:"bg-green-100 text-green-800",influencer:"bg-pink-100 text-pink-800",client:"bg-gray-100 text-gray-800"})[e]}e.s(["getRoleBadgeColor",()=>d,"getRoleDisplayName",()=>l,"hasMinimumRole",()=>r,"hasRole",()=>a,"isCampaignManagerOrHigher",()=>s,"isDirector",()=>n,"isRouteAllowed",()=>i])},42869,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566),n=e.i(26683),s=e.i(83642),i=e.i(17927),l=e.i(4249);function d(){return(0,t.jsx)(n.default,{children:(0,t.jsx)(c,{})})}function c(){let{user:e,profile:n}=(0,s.useAuth)(),d=(0,r.useRouter)(),c=(0,r.useParams)(),[o,u]=(0,a.useState)(null),[m,g]=(0,a.useState)(null),[x,p]=(0,a.useState)([]),[h,f]=(0,a.useState)(null),[b,v]=(0,a.useState)(null),[j,y]=(0,a.useState)(!0),[N,_]=(0,a.useState)(!1),[w,C]=(0,a.useState)({title:"",description:"",platform:"",format:"",internal_deadline:"",client_deadline:"",assigned_influencer_id:""}),k=(0,l.isCampaignManagerOrHigher)(n);async function D(){try{y(!0);let{data:e,error:t}=await i.supabase.from("campaigns").select("*").eq("id",c.id).single();if(t)throw t;if(u(e),e.client_id){let{data:t}=await i.supabase.from("clients").select("*").eq("id",e.client_id).single();t&&g(t)}if(e.campaign_manager_id){let{data:t}=await i.supabase.from("profiles").select("*").eq("id",e.campaign_manager_id).single();t&&f(t)}if(e.reviewer_id){let{data:t}=await i.supabase.from("profiles").select("*").eq("id",e.reviewer_id).single();t&&v(t)}let{data:a}=await i.supabase.from("content_items").select("*").eq("campaign_id",c.id).order("created_at",{ascending:!1});a&&p(a)}catch(e){console.error("Error loading campaign:",e)}finally{y(!1)}}async function S(e){if(k&&o)try{let{error:t}=await i.supabase.from("campaigns").update({status:e}).eq("id",o.id);if(t)throw t;u({...o,status:e})}catch(e){console.error("Error updating status:",e),alert("Failed to update campaign status")}}async function R(){if(o)try{let{data:e,error:t}=await i.supabase.from("content_items").insert([{campaign_id:o.id,title:w.title,description:w.description,platform:w.platform,format:w.format,internal_deadline:w.internal_deadline||null,client_deadline:w.client_deadline||null,assigned_influencer_id:w.assigned_influencer_id||null,status:"draft",current_version:0}]).select().single();if(t)throw t;p([e,...x]),_(!1),C({title:"",description:"",platform:"",format:"",internal_deadline:"",client_deadline:"",assigned_influencer_id:""})}catch(e){console.error("Error adding content:",e),alert("Failed to add content item")}}async function A(e){if(k&&confirm("Are you sure you want to delete this content item?"))try{let{error:t}=await i.supabase.from("content_items").delete().eq("id",e);if(t)throw t;p(x.filter(t=>t.id!==e))}catch(e){console.error("Error deleting content:",e),alert("Failed to delete content item")}}function q(e){return({draft:"bg-gray-100 text-gray-800",brief_pending:"bg-yellow-100 text-yellow-800",active:"bg-blue-100 text-blue-800",content_review:"bg-purple-100 text-purple-800",client_review:"bg-indigo-100 text-indigo-800",completed:"bg-green-100 text-green-800",archived:"bg-gray-100 text-gray-600",pending_internal:"bg-yellow-100 text-yellow-800",internal_rejected:"bg-red-100 text-red-800",pending_client:"bg-yellow-100 text-yellow-800",client_rejected:"bg-red-100 text-red-800",approved:"bg-green-100 text-green-800",published:"bg-green-600 text-white"})[e]||"bg-gray-100 text-gray-800"}return((0,a.useEffect)(()=>{D()},[c.id]),j)?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,t.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-6"}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3"})]})]})})}):o?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("button",{onClick:()=>d.push("/campaigns"),className:"text-blue-600 hover:text-blue-800 mb-2 flex items-center",children:"â† Back to Campaigns"}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:o.campaign_code}),(0,t.jsx)("p",{className:"text-xl text-gray-600",children:o.name})]}),(0,t.jsx)("span",{className:`px-4 py-2 rounded-full text-sm font-medium ${q(o.status)}`,children:o.status.replace(/_/g," ").toUpperCase()})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Campaign Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Client"}),(0,t.jsx)("p",{className:"font-medium",children:m?.company_name||"Not assigned"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Campaign Manager"}),(0,t.jsx)("p",{className:"font-medium",children:h?.full_name||"Not assigned"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Reviewer"}),(0,t.jsx)("p",{className:"font-medium",children:b?.full_name||"Not assigned"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Budget"}),(0,t.jsx)("p",{className:"font-medium",children:o.budget_amount?`${o.budget_currency} ${o.budget_amount.toLocaleString()}`:"Not set"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Start Date"}),(0,t.jsx)("p",{className:"font-medium",children:o.start_date?new Date(o.start_date).toLocaleDateString():"Not set"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"End Date"}),(0,t.jsx)("p",{className:"font-medium",children:o.end_date?new Date(o.end_date).toLocaleDateString():"Not set"})]}),o.brief_approved_at&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Brief Approved"}),(0,t.jsx)("p",{className:"font-medium",children:new Date(o.brief_approved_at).toLocaleDateString()})]})]}),k&&(0,t.jsxs)("div",{className:"mt-6 pt-6 border-t",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Update Status"}),(0,t.jsxs)("select",{value:o.status,onChange:e=>S(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,t.jsx)("option",{value:"draft",children:"Draft"}),(0,t.jsx)("option",{value:"brief_pending",children:"Brief Pending"}),(0,t.jsx)("option",{value:"active",children:"Active"}),(0,t.jsx)("option",{value:"content_review",children:"Content Review"}),(0,t.jsx)("option",{value:"client_review",children:"Client Review"}),(0,t.jsx)("option",{value:"completed",children:"Completed"}),(0,t.jsx)("option",{value:"archived",children:"Archived"})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-gray-800",children:["Content Items (",x.length,")"]}),k&&!N&&(0,t.jsx)("button",{onClick:()=>_(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"+ Add Content Item"})]}),N&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-800 mb-4",children:"New Content Item"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),(0,t.jsx)("input",{type:"text",value:w.title,onChange:e=>C({...w,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Platform *"}),(0,t.jsx)("input",{type:"text",value:w.platform,onChange:e=>C({...w,platform:e.target.value}),placeholder:"e.g., Instagram, TikTok, YouTube",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Format"}),(0,t.jsx)("input",{type:"text",value:w.format,onChange:e=>C({...w,format:e.target.value}),placeholder:"e.g., Reel, Story, Post",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Internal Deadline"}),(0,t.jsx)("input",{type:"date",value:w.internal_deadline,onChange:e=>C({...w,internal_deadline:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Deadline"}),(0,t.jsx)("input",{type:"date",value:w.client_deadline,onChange:e=>C({...w,client_deadline:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,t.jsx)("textarea",{value:w.description,onChange:e=>C({...w,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,t.jsx)("button",{onClick:R,disabled:!w.title||!w.platform,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Add Content Item"}),(0,t.jsx)("button",{onClick:()=>_(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]}),0===x.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:"No content items yet"}),k&&!N&&(0,t.jsx)("button",{onClick:()=>_(!0),className:"text-blue-600 hover:text-blue-800",children:"Add your first content item"})]}):(0,t.jsx)("div",{className:"space-y-4",children:x.map(e=>(0,t.jsx)("div",{className:"p-4 border border-gray-200 rounded-lg hover:border-blue-300 transition",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-800",children:e.title}),(0,t.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${q(e.status)}`,children:e.status.replace(/_/g," ").toUpperCase()})]}),e.description&&(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,t.jsxs)("div",{className:"flex gap-4 text-sm text-gray-500",children:[(0,t.jsxs)("span",{children:["ðŸ“± ",e.platform]}),e.format&&(0,t.jsxs)("span",{children:["ðŸŽ¨ ",e.format]}),e.current_version>0&&(0,t.jsxs)("span",{children:["ðŸ“„ v",e.current_version]}),e.internal_deadline&&(0,t.jsxs)("span",{children:["ðŸ“… Internal: ",new Date(e.internal_deadline).toLocaleDateString()]}),e.client_deadline&&(0,t.jsxs)("span",{children:["ðŸ‘¤ Client: ",new Date(e.client_deadline).toLocaleDateString()]})]})]}),k&&(0,t.jsx)("button",{onClick:()=>A(e.id),className:"text-red-600 hover:text-red-800 ml-4",children:"Delete"})]})},e.id))})]})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,t.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Campaign Not Found"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"The campaign you're looking for doesn't exist or you don't have access to it."}),(0,t.jsx)("button",{onClick:()=>d.push("/campaigns"),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to Campaigns"})]})})})}e.s(["default",()=>d])}]);